<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>mizer blog: Age in mizer</title>

<meta property="description" itemprop="description" content="In this blog post, we introduce an extension that allows you to calculate&#10;dynamic growth curves and ages at size in mizer. This addition will improve how&#10;mizer is calibrated to data and also allows it to be interpreted and compared &#10;to age-based models, potentially increasing the utility of mizer in the &#10;assessment and advice process."/>

<link rel="canonical" href="https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/png" href="../../images/favicon-16x16.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2025-04-02"/>
<meta property="article:created" itemprop="dateCreated" content="2025-04-02"/>
<meta name="article:author" content="Luke Broadbent"/>
<meta name="article:author" content="Michael A. Spence"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="mizer blog: Age in mizer"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In this blog post, we introduce an extension that allows you to calculate&#10;dynamic growth curves and ages at size in mizer. This addition will improve how&#10;mizer is calibrated to data and also allows it to be interpreted and compared &#10;to age-based models, potentially increasing the utility of mizer in the &#10;assessment and advice process."/>
<meta property="og:url" content="https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/"/>
<meta property="og:image" content="https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/pictures/aging_mizer_toy.png"/>
<meta property="og:image:width" content="528"/>
<meta property="og:image:height" content="480"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="mizer blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="mizer blog: Age in mizer"/>
<meta property="twitter:description" content="In this blog post, we introduce an extension that allows you to calculate&#10;dynamic growth curves and ages at size in mizer. This addition will improve how&#10;mizer is calibrated to data and also allows it to be interpreted and compared &#10;to age-based models, potentially increasing the utility of mizer in the &#10;assessment and advice process."/>
<meta property="twitter:url" content="https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/"/>
<meta property="twitter:image" content="https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/pictures/aging_mizer_toy.png"/>
<meta property="twitter:image:width" content="528"/>
<meta property="twitter:image:height" content="480"/>
<meta property="twitter:site" content="@mizer_model"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="mizer blog: Age in mizer"/>
<meta name="citation_fulltext_html_url" content="https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2025/04/02"/>
<meta name="citation_publication_date" content="2025/04/02"/>
<meta name="citation_author" content="Luke Broadbent"/>
<meta name="citation_author_institution" content="Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK"/>
<meta name="citation_author" content="Michael A. Spence"/>
<meta name="citation_author_institution" content="Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Fish ecology, evolution, and exploitation: A new theoretical synthesis;citation_publisher=Princeton University Press;citation_author=Ken H. Andersen"/>
  <meta name="citation_reference" content="citation_title=Evaluating targets and trade-offs among fisheries and conservation objectives using a multispecies size spectrum model;citation_volume=51;citation_doi=10.1111/1365-2664.12238;citation_author=Julia L. Blanchard;citation_author=Ken H. Andersen;citation_author=Finlay Scott;citation_author=Niels T. Hintzen;citation_author=Gerjan Piet;citation_author=Simon Jennings"/>
  <meta name="citation_reference" content="citation_title=Food web framework for size-structured populations;citation_volume=272;citation_doi=10.1016/j.jtbi.2010.12.006;citation_author=Martin Hartvig;citation_author=Ken H. Andersen;citation_author=Jan E. Beyer"/>
  <meta name="citation_reference" content="citation_title=Working group on multispecies assessment methods (WGSAM; outputs from 2023 meeting);citation_doi=10.17895/ices.pub.25020968.v3;citation_author=Working group on multispecies assessment methods (WGSAM; outputs from 2023 meeting)"/>
  <meta name="citation_reference" content="citation_title=A stochastic age-length-structured multispecies model applied to north sea stocks;citation_publisher=ICES;citation_author=Peter Lewy;citation_author=Morten Vinther"/>
  <meta name="citation_reference" content="citation_title=Estimation of time-varying selectivity in stock assessments using state-space models;citation_volume=158;citation_doi=10.1016/j.fishres.2014.01.014;citation_author=Anders Nielsen;citation_author=Casper W. Berg"/>
  <meta name="citation_reference" content="citation_title=Management strategy evaluation: Best practices;citation_volume=17;citation_doi=10.1111/faf.12104;citation_author=Andre E. Punt;citation_author=Doug S. Butterworth;citation_author=Carryn L. Moor;citation_author=JosÃ© A. A. De Oliveira;citation_author=Malcolm Haddon"/>
  <meta name="citation_reference" content="citation_title=Mizer: An r package for multispecies, trait-based and community size spectrum ecological modelling;citation_volume=5;citation_doi=10.1111/2041-210X.12256;citation_author=Finlay Scott;citation_author=Julia L. Blanchard;citation_author=Ken H. Andersen"/>
  <meta name="citation_reference" content="citation_title=Parameter uncertainty of a dynamic multispecies size spectrum model;citation_volume=73;citation_doi=10.1139/cjfas-2015-0022;citation_author=Michael A. Spence;citation_author=Paul G. Blackwell;citation_author=Julia L. Blanchard"/>
  <meta name="citation_reference" content="citation_title=Assessing the effect of multispecies interactions on precautionary reference points using an ensemble modelling approach: A north sea case study;citation_volume=280;citation_doi=10.1016/j.fishres.2024.107160;citation_author=Michael A. Spence;citation_author=James A. Martindale;citation_author=Khatija Alliji;citation_author=Hayley J. Bannister;citation_author=Robert B. Thorpe;citation_author=Nicola D. Walker;citation_author=Peter J. Mitchell;citation_author=Matthew R. Kerr;citation_author=Paul J. Dolder"/>
  <meta name="citation_reference" content="citation_title=Quantifying uncertainty and dynamical changes in multi-species fishing mortality rates, catches and biomass by combining state-space and size-based multi-species models;citation_volume=22;citation_doi=10.1111/faf.12543;citation_author=Michael A. Spence;citation_author=Robert B. Thorpe;citation_author=Paul G. Blackwell;citation_author=Finlay Scott;citation_author=Richard Southwell;citation_author=Julia L. Blanchard"/>
  <meta name="citation_reference" content="citation_title=Performance of multispecies assessment models: Insights on the influence of diet data;citation_volume=76;citation_doi=10.1093/icesjms/fsz053;citation_author=Vanessa Trijoulet;citation_author=Gavin Fay;citation_author=Kiersten L. Curti;citation_author=Brian Smith;citation_author=Timothy J. Miller"/>
  <meta name="citation_reference" content="citation_title=Performance of a state-space multispecies model: What are the consequences of ignoring predation and process errors in stock assessments?;citation_volume=57;citation_doi=10.1111/1365-2664.13515;citation_author=Vanessa Trijoulet;citation_author=Gavin Fay;citation_author=Timothy J. Miller"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","output","bibliography","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Age in mizer"]},{"type":"character","attributes":{},"value":["In this blog post, we introduce an extension that allows you to calculate\ndynamic growth curves and ages at size in mizer. This addition will improve how\nmizer is calibrated to data and also allows it to be interpreted and compared \nto age-based models, potentially increasing the utility of mizer in the \nassessment and advice process."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","email"]}},"value":[{"type":"character","attributes":{},"value":["Luke Broadbent"]},{"type":"character","attributes":{},"value":["Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK"]},{"type":"character","attributes":{},"value":["luke.broadbent@cefas.gov.uk"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","email"]}},"value":[{"type":"character","attributes":{},"value":["Michael A. Spence"]},{"type":"character","attributes":{},"value":["Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK"]},{"type":"character","attributes":{},"value":["michael.spence@cefas.gov.uk"]}]}]},{"type":"character","attributes":{},"value":["2025-04-02"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","number_sections","toc","df_print"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["paged"]}]}]},{"type":"character","attributes":{},"value":["bibliography.bib"]},{"type":"character","attributes":{},"value":["https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/"]},{"type":"character","attributes":{},"value":["https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["age-in-mizer_files/anchor-4.2.2/anchor.min.js","age-in-mizer_files/bowser-1.9.3/bowser.min.js","age-in-mizer_files/distill-2.2.21/template.v2.js","age-in-mizer_files/figure-html5/unnamed-chunk-10-1.png","age-in-mizer_files/figure-html5/unnamed-chunk-11-1.png","age-in-mizer_files/figure-html5/unnamed-chunk-3-1.png","age-in-mizer_files/figure-html5/unnamed-chunk-4-1.png","age-in-mizer_files/figure-html5/unnamed-chunk-5-1.png","age-in-mizer_files/figure-html5/unnamed-chunk-9-1.png","age-in-mizer_files/header-attrs-2.29/header-attrs.js","age-in-mizer_files/jquery-3.6.1/jquery-3.6.1.js","age-in-mizer_files/jquery-3.6.1/jquery-3.6.1.min.js","age-in-mizer_files/jquery-3.6.1/jquery-3.6.1.min.map","age-in-mizer_files/popper-2.6.0/popper.min.js","age-in-mizer_files/tippy-6.2.7/tippy-bundle.umd.min.js","age-in-mizer_files/tippy-6.2.7/tippy-light-border.css","age-in-mizer_files/tippy-6.2.7/tippy.css","age-in-mizer_files/tippy-6.2.7/tippy.umd.min.js","age-in-mizer_files/webcomponents-2.0.0/webcomponents.js","bibliography.bib","pictures/abmovement.png","pictures/aging_mizer_toy.png","pictures/cohort_plog.png","pictures/cohort_plot.png","pictures/cohorts_plot.png","pictures/growth_curve.png","pictures/natural_mort_plots.png","pictures/quantiles.png","pictures/SENSITIVEGRID.png","pictures/whiting_obs_miz.png","pictures/Zs_plot_whiting.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #317eac;
  --header-color:    #317eac;
  --body-color:      #555555;
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Helvetica Neue",Helvetica,Arial,sans-serif;
  --mono-font:       monospace;
  --body-font:       "Helvetica Neue",Helvetica,Arial,sans-serif;
  --navbar-font:     "Helvetica Neue",Helvetica,Arial,sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
  padding: 0 0;
}

d-title {
  padding-bottom: 0.2rem;
  background-color:  #ffffff;
  color: #555555;
}

d-byline .byline h3 {
    margin-block-start: 0;
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       #ffffff;
  --text-size:        18px;
  --hover-color:      white;
  --bkgd-color:       #30bbed;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #30bbed;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
a .metadata {
  color: #555555;
}
a .description {
  color: #555555;
}
d-article a:hover, a:focus {
  color: #157ab5;
  text-decoration: underline;
  border-bottom: none;
}

d-article a {
  color: #2fa4e7;
  text-decoration: none;
  border-bottom: none;
}


d-article pre a  {
  color: inherit;
}

.distill-site-nav a:hover {
    color: white;
    background-color: #178acc;
}

code {
    padding: 2px 4px;
    font-size: 90%;
    color: #c7254e;
    background-color: #f9f2f4;
    border-radius: 4px;
}

h1.posts-list-caption {
  content: url("images/mizer.png");
  width: 66%;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Age in mizer","description":"In this blog post, we introduce an extension that allows you to calculate\ndynamic growth curves and ages at size in mizer. This addition will improve how\nmizer is calibrated to data and also allows it to be interpreted and compared \nto age-based models, potentially increasing the utility of mizer in the \nassessment and advice process.","authors":[{"author":"Luke Broadbent","authorURL":"#","affiliation":"Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK","affiliationURL":"#","orcidID":""},{"author":"Michael A. Spence","authorURL":"#","affiliation":"Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK","affiliationURL":"#","orcidID":""}],"publishedDate":"2025-04-02T00:00:00.000+01:00","citationText":"Broadbent & Spence, 2025"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">mizer blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="https://sizespectrum.org/mizer/">mizer home</a>
<a href="https://twitter.com/mizer_model">
<i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
</a>
<a href="../../index.xml">
<i class="fa fa-rss fa-lg" aria-hidden="true"></i>
</a>
<a href="https://github.com/sizespectrum/mizerBlog">
<i class="fab fa-github fa-lg" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Age in mizer</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>In this blog post, we introduce an extension that allows you to calculate
dynamic growth curves and ages at size in mizer. This addition will improve how
mizer is calibrated to data and also allows it to be interpreted and compared
to age-based models, potentially increasing the utility of mizer in the
assessment and advice process.</p></p>
</div>

<div class="d-byline">
  Luke Broadbent  (Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK)
  
,   Michael A. Spence  (Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, Suffolk NR33 0HT, UK)
  
<br/>2025-04-02
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#calculating-age-in-mizer" id="toc-calculating-age-in-mizer">Calculating age in mizer</a>
<ul>
<li><a href="#sec:numatage" id="toc-sec:numatage">Numbers at age</a></li>
<li><a href="#sec:Zatage" id="toc-sec:Zatage">Mortality rates</a></li>
</ul></li>
<li><a href="#sec:Sens" id="toc-sec:Sens">Sensitivity to <code>no_w</code> and <code>dt</code></a></li>
<li><a href="#discussion" id="toc-discussion">Discussion</a></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<p>The majority of assessment models for category 1 stocks in the International Council for Exploration of the Seas (ICES) are age based. This is a natural way of thinking about population dynamics as in a closed system, the number of individuals in a cohort, <span class="math inline">\(N\)</span>, can only go down as they die. The dynamics of a cohort are
<span class="math display" id="eq:dummy11">\[\begin{equation}
    \frac{dN}{dt}=-ZN
    \tag{1}
\end{equation}\]</span>
where <span class="math inline">\(Z=F+M\)</span>, with <span class="math inline">\(F\)</span> being the fishing mortality and <span class="math inline">\(M\)</span> being the natural mortality. Fishing mortality and natural mortality can vary in time.
For an age-based model this has the solution that the numbers at time <span class="math inline">\(t\)</span> in age-class <span class="math inline">\(a\)</span> is
<span class="math display" id="eq:grow">\[\begin{equation}
    N_{a,t}=N_{a-1,t-1}\exp(-Z_{a-1,t})
    \tag{2}
\end{equation}\]</span>
for <span class="math inline">\(a=2,\ldots{},A-1\)</span> and <span class="math inline">\(t=1,\ldots\)</span>. For the first age-class, the number in the new cohort is the recruits
<span class="math display" id="eq:dummy">\[\begin{equation}
    N_{1,t}=R_{t}\exp(-Z_{0,t})
    \tag{3}
\end{equation}\]</span>
for all <span class="math inline">\(t\)</span>. Often <span class="math inline">\(Z_{0,t}\)</span> is zero if there are no catches of age-class one in the data.
The final age class, <span class="math inline">\(A\)</span>, is a plus group, which means there is no maximum age of a fish,
<span class="math display" id="eq:plus">\[\begin{equation}
    N_{A,t}=N_{A-1,t-1}\exp(-Z_{A-1,t}) + N_{A,t-1}\exp(-Z_{A,t}),
    \tag{4}
\end{equation}\]</span>
with <span class="math inline">\(Z_{a,t}=M_{a,t}+F_{a,t}\)</span> for <span class="math inline">\(a=0,\ldots{},A\)</span> and all times.
Note that these are age classes that have the interval one year and not the ages of the fish. Some stocks have the first age class being age 0 (e.g.Â North Sea whiting), where as other have the first age class being older (e.g.Â age 3 for North Sea saithe).</p>
<p>Most category 1 assessments are based on equations <a href="#eq:grow">(2)</a>â<a href="#eq:plus">(4)</a>, with additional features <span class="citation" data-cites="sam">(e.g., process error in <a href="#ref-sam" role="doc-biblioref">Nielsen and Berg 2014</a>)</span>. The same equations are commonly the basis to give catch advice, calculate reference points (e.g.Â MSY) and perform management strategy evaluations (MSE).</p>
<p>A lot of data studies are specifically designed to collect data for age-based models. For example, fish that are aged on surveys using a length-stratified design.
This design is good for finding the age at length, so that fish can be aged just by knowing their length and numbers at age can be calculated. However, the design is not as good at finding length from age, which means that growth curves can be difficult to calculate.</p>
<p>There are also many multispecies models that are age-based <span class="citation" data-cites="Trijoulet_19 Trijoulet_20 sms">(<a href="#ref-Trijoulet_19" role="doc-biblioref">Trijoulet et al. 2019</a>; <a href="#ref-Trijoulet_20" role="doc-biblioref">Trijoulet, Fay, and Miller 2020</a>; <a href="#ref-sms" role="doc-biblioref">Lewy and Vinther 2004</a>)</span>. In some cases, emergent natural mortality from age-based multispecies models are used as inputs to single-species assessments <span class="citation" data-cites="ICES2024">(e.g., <a href="#ref-ICES2024" role="doc-biblioref">ICES 2024</a>)</span>.</p>
<p>Despite strong arguments for adopting size-based models over age-based models <span class="citation" data-cites="Andersen_book">(<a href="#ref-Andersen_book" role="doc-biblioref">Andersen 2019</a>)</span> , we are unaware of any data-rich assessments that use size-based models. This work was motivated by the aim to use the multispecies size spectrum model, mizer <span class="citation" data-cites="hartvig blanchard mizer">(<a href="#ref-hartvig" role="doc-biblioref">Hartvig, Andersen, and Beyer 2011</a>; <a href="#ref-blanchard" role="doc-biblioref">Blanchard et al. 2014</a>; <a href="#ref-mizer" role="doc-biblioref">Scott, Blanchard, and Andersen 2014</a>)</span> as an age-based model to fit with current assessment and MSE frameworks. This will take advantage of the mechanistic dynamics of the mizer model, while keeping to the age-structured frameworks used in ICES.</p>
<p>In this blog we will explain and demonstrate how we calculate emergent age in mizer.</p>
<h1 id="calculating-age-in-mizer">Calculating age in mizer</h1>
<p>Growth is an emergent property of feeding <span class="citation" data-cites="Andersen_book">(<a href="#ref-Andersen_book" role="doc-biblioref">Andersen 2019</a>)</span> and so is
size-at-age. To calculate the emergent size at age in mizer at time
<span class="math inline">\(t_0\)</span>, we introduce an <em>immortal individual</em> (II) of species <span class="math inline">\(i\)</span> and
track the size of that individual. At time <span class="math inline">\(t\)</span>, the size of the II will
be <span class="math inline">\(I_i(t_0,t)\)</span>, with
<span class="math display" id="eq:IIpde">\[\begin{equation}
\frac{\partial I_i}{\partial t} \;=\; g_i\bigl(I_i(t_0,t),t\bigr).
\tag{5}
\end{equation}\]</span>
Solving this from <span class="math inline">\(t_0\)</span> to time <span class="math inline">\(T\)</span> with boundary condition
<span class="math inline">\(I_i(t_0, t_0) = w_{0,i}\)</span>, we know that an individual of species <span class="math inline">\(i\)</span> and
age <span class="math inline">\(T - t_0\)</span> will be size <span class="math inline">\(I_i(t_0, T)\)</span>. In mizer, fish cannot overtake
each other in size, therefore we know that fish smaller than <span class="math inline">\(I_i(T)\)</span> will be
younger, and larger fish will be older. If we introduce such IIs at
annual increments, then we can follow different age classes throughout
the model. Figure <a href="#fig:ageingmizer">1</a> demonstrates the process, showing how, for a given species, age is calculated.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ageingmizer"></span>
<img src="pictures/aging_mizer_toy.png" alt="Demonstration of how we calculate weights for immortal individuals across time. Each line represents the weight of one II, each introduced annually." width="500px" height="500px" />
<p class="caption">
Figure 1: Demonstration of how we calculate weights for immortal individuals across time. Each line represents the weight of one II, each introduced annually.
</p>
</div>
</div>
<p>We solve equation <a href="#eq:IIpde">(5)</a> in mizer for time <code>dt</code> numerically given weight classes <code>w</code>, with differences <code>dw</code>. If at the current time the II is size <code>cur_waa</code> then it will be in size class</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cur_idx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>cur_waa</span> <span class='op'>&gt;=</span> <span class='va'>params</span><span class='op'>@</span><span class='va'>w</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>and will grow at rate</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>grow</span><span class='op'>[</span><span class='va'>cur_idx</span><span class='op'>]</span></span>
<span><span class='va'>time_to_end</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>togro</span> <span class='op'>-</span> <span class='va'>cur_waa</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>g</span> <span class='co'># how far is next size class, can i grow it in dt?</span></span></code></pre>
</div>
</div>
<p>It will grow at this rate until it reaches the next size class</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>togro</span> <span class='op'>&lt;-</span> <span class='va'>params</span><span class='op'>@</span><span class='va'>w</span><span class='op'>[</span><span class='va'>cur_idx</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>]</span></span></code></pre>
</div>
</div>
<p>which will take time</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>time_to_end</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>togro</span> <span class='op'>-</span> <span class='va'>cur_waa</span><span class='op'>)</span> <span class='op'>/</span> <span class='va'>g</span></span></code></pre>
</div>
</div>
<p>Initially the II will grow for time <code>dt</code> but will move through weight classes. We monitor how long is left to grow with variable <code>time_left</code> intially setting it to <code>dt</code>. If <code>time_to_end&lt;=time_left</code> then the IIâs weight will be</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cur_waa</span> <span class='op'>&lt;-</span> <span class='va'>cur_waa</span> <span class='op'>+</span> <span class='va'>g</span> <span class='op'>*</span> <span class='va'>time_left</span></span></code></pre>
</div>
</div>
<p>otherwise it will grow to the next size class for <code>time_to_end</code> and we update the time remaining</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cur_waa</span> <span class='op'>&lt;-</span> <span class='va'>cur_waa</span> <span class='op'>+</span> <span class='va'>g</span> <span class='op'>*</span> <span class='va'>time_to_end</span></span>
<span><span class='va'>time_left</span> <span class='op'>&lt;-</span> <span class='va'>time_left</span> <span class='op'>-</span> <span class='va'>time_to_end</span> </span></code></pre>
</div>
</div>
<p>The process is repeated until <code>time_to_end&lt;=time_left</code>.</p>
<p>Figure <a href="#fig:aging-weights">2</a> shows the emergent weight at age for whiting in mizer.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:aging-weights"></span>
<img src="pictures/growth_curve.png" alt="Emergent growth curve for whiting." width="500px" height="500px" />
<p class="caption">
Figure 2: Emergent growth curve for whiting.
</p>
</div>
</div>
<p>We added the above to the <code>project</code> and <code>project_simple</code> functions so that it updates the size of the IIs each <code>dt</code>. In addition we added a new slot to the <code>MizerSim</code> objects so that we can store the weight at age for all ages, time steps and species, <code>waa</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#the mizerSim object - now with a waa section</span></span>
<span><span class='kw'>setClass</span><span class='op'>(</span> </span>
<span>    <span class='st'>"MizerSim"</span>,</span>
<span>    slots <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        params <span class='op'>=</span> <span class='st'>"MizerParams"</span>,</span>
<span>        n <span class='op'>=</span> <span class='st'>"array"</span>,</span>
<span>        effort <span class='op'>=</span> <span class='st'>"array"</span>,</span>
<span>        n_pp <span class='op'>=</span> <span class='st'>"array"</span>,</span>
<span>        n_other <span class='op'>=</span> <span class='st'>"array"</span>,</span>
<span>        waa <span class='op'>=</span> <span class='st'>"array"</span></span>
<span>    <span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Each year we add a new II, and also remove the oldest II at the same time. We give an argument to <code>project</code> to input the initial weights at age (<code>waa_initial</code>), a matrix with dimensions number of species and maximum age (defaulted to 20), <code>nages</code>. If absent the initial weights at age are calculated from the <code>getGrowthCurves</code> function.</p>
<p>The <code>project</code> function will now return a <code>mizerSim</code> object with a <code>waa</code> slot which contains an <code>array</code> with the dimensions <code>t_max*t_save</code>, number of species and <code>nages</code>.</p>
<p>We demonstrate the weight at age using the North Sea model with fishing mortality from stock assessments (<code>historicfishingM</code> see <span class="citation" data-cites="spence_prec">Spence et al. (<a href="#ref-spence_prec" role="doc-biblioref">2024</a>)</span>) from 1984 to 2019. We ran the model to the steady state by running it for 100 years using 1984 fishing and then projected it to 2019.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#project to steady state - so that we can use the waa generated here as initial_waa</span></span>
<span><span class='co'>#fishing array is the historicfishingM remade for mizer</span></span>
<span><span class='va'>tosteady</span> <span class='op'>&lt;-</span> <span class='fu'>project</span><span class='op'>(</span><span class='va'>params</span>, effort <span class='op'>=</span> <span class='va'>fishing_array</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span>,t_max <span class='op'>=</span><span class='fl'>100</span>, initial_n <span class='op'>=</span> <span class='va'>params</span><span class='op'>@</span><span class='va'>initial_n</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#projecting, using the values from the end of the steady state run for n, npp and waa</span></span>
<span><span class='va'>projection</span> <span class='op'>&lt;-</span> <span class='fu'>project</span><span class='op'>(</span><span class='va'>params</span>, effort <span class='op'>=</span> <span class='va'>fishing_array</span>,  initial_n <span class='op'>=</span> <span class='op'>(</span><span class='va'>tosteady</span><span class='op'>@</span><span class='va'>n</span><span class='op'>)</span><span class='op'>[</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>tosteady</span><span class='op'>@</span><span class='va'>n</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>,,<span class='op'>]</span>,</span>
<span>                      initial_n_pp <span class='op'>=</span> <span class='op'>(</span><span class='va'>tosteady</span><span class='op'>@</span><span class='va'>n_pp</span><span class='op'>)</span><span class='op'>[</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>tosteady</span><span class='op'>@</span><span class='va'>n</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>,<span class='op'>]</span>,</span>
<span>                      waa_initial <span class='op'>=</span> <span class='va'>tosteady</span><span class='op'>@</span><span class='va'>waa</span><span class='op'>[</span><span class='fl'>1001</span>,,<span class='op'>]</span><span class='op'>)</span> </span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:historic-weights"></span>
<img src="pictures/whiting_obs_miz.png" alt="The black line shows the weight at age inputs to SMS' key-run [@ICES2024] (and the stock assessent) for whiting and the red line shows the mizer estimate of weight at age for whiting using `NS_params`" width="80%" />
<p class="caption">
Figure 3: The black line shows the weight at age inputs to SMSâ key-run <span class="citation" data-cites="ICES2024">(<a href="#ref-ICES2024" role="doc-biblioref">ICES 2024</a>)</span> (and the stock assessent) for whiting and the red line shows the mizer estimate of weight at age for whiting using <code>NS_params</code>
</p>
</div>
</div>
<p>In Figure <a href="#fig:historic-weights">3</a> we show the size at age of whiting and compare it to weight at age inputs to SMSâ key-run <span class="citation" data-cites="ICES2024">(<a href="#ref-ICES2024" role="doc-biblioref">ICES 2024</a>)</span>. Using the default mizer model <code>NS_params</code> we show that the weight at age of whiting changes over the simulation, with a similar pattern to the inputs to SMS, however, the scale and range are different.</p>
<h2 id="sec:numatage">Numbers at age</h2>
<p>Given the IIs we can calculate the numbers at age. Suppose that at time <span class="math inline">\(t\)</span> the density of numbers at weight is shown below, with IIs aged one, <span class="math inline">\(I_i(t-1,t)=0.2\)</span>, and two, <span class="math inline">\(I_i(t-2,t)=5\)</span>, being shown.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="age-in-mizer_files/figure-html5/unnamed-chunk-9-1.png" width="624" style="display: block; margin: auto;" /></p>
</div>
<p>The numbers younger than age one are all of the individuals smaller than <span class="math inline">\(I_i(t-1,t)=0.2\)</span>, which in the figure above is 14671.88. The number of individuals younger than two years old are smaller than <span class="math inline">\(I_i(t-2,t)=5\)</span>, which in the figure is 17671.88. Therefore, 14671.88 are in the youngest age class (less than one years old) and 3000 individuals are in the age class between one and two years old.</p>
<p>In this example the IIs were on the boundary of the weight-classes. However, in practice this will almost surely not happen. The IIs will fall between weight-classes, and so, to assign an age to individuals in that weight-class we describe how individuals are distributed within the weight class. The plot below is more likely:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="age-in-mizer_files/figure-html5/unnamed-chunk-10-1.png" width="624" style="display: block; margin: auto;" /></p>
</div>
<p>It is clear that the individuals in the red bars are less than one, and the individuals in the blue bar are less than two but older than one, but it is not clear how old the individuals in the white bars are.</p>
<p>Defining how the individuals in the white bars are distributed is down to the user. In this work we defined it as following a power law. Specifically the density of individuals between sizes <span class="math inline">\(w_0\)</span> and <span class="math inline">\(w_1\)</span> was
<span class="math display">\[\begin{equation}
\alpha{}w^{\beta}.
\end{equation}\]</span>
We set
<span class="math display">\[\begin{equation}
\beta=\frac{\log(n(w_1))-\log(n(w_0))}{\log(w_1)-\log(w_0)},
\end{equation}\]</span>
and
<span class="math display">\[\begin{equation}
\alpha=\frac{n(w_0)(w_1-w_0)(\beta+1)}{w_1^{\beta+1}-w_0^{\beta+1}},
\end{equation}\]</span>
which ensures that the total number in the weight-class is constant in both cases.</p>
<p>The example above becomes:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="age-in-mizer_files/figure-html5/unnamed-chunk-11-1.png" width="624" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cohort-plot"></span>
<img src="pictures/cohort_plot.png" alt="The top plot shows the evolution of individual whiting cohorts through time. The lower plots shows the fishing mortality over time for whiting from @spence_prec" width="500px" height="700px" />
<p class="caption">
Figure 4: The top plot shows the evolution of individual whiting cohorts through time. The lower plots shows the fishing mortality over time for whiting from <span class="citation" data-cites="spence_prec">Spence et al. (<a href="#ref-spence_prec" role="doc-biblioref">2024</a>)</span>
</p>
</div>
</div>
<h2 id="sec:Zatage">Mortality rates</h2>
<p>By calculating the numbers at age, as done in Section <a href="#sec:numatage"><strong>??</strong></a>, we can calculate how many individuals die in a cohort in a year. Consider that at time <span class="math inline">\(t-1\)</span> and <span class="math inline">\(t\)</span> we have calculated numbers age <span class="math inline">\(a-1\)</span> and <span class="math inline">\(a\)</span> respectively, then we can rearrange equation <a href="#eq:grow">(2)</a> to find
<span class="math display" id="eq:getZ">\[\begin{equation}
    Z_{a-1,t-1}=-\ln(N_{a,t})+\ln(N_{a-1,t-1}).
    \tag{6}
\end{equation}\]</span>
This is the total mortality for age <span class="math inline">\(a-1\)</span> at time <span class="math inline">\(t-1\)</span>. By calculating the numbers caught at age <span class="math inline">\(a\)</span> in time <span class="math inline">\(t-1\)</span>, <span class="math inline">\(C_{a-1,t-1}\)</span>, in a similar way to how we calculate the numbers at age, we can calculate the fishing mortality
<span class="math display" id="eq:getF">\[\begin{equation}
    F_{a-1,t-1}=\frac{Z_{a-1,t-1}C_{a-1,t-1}}{N_{a-1,t-1}(1-\exp(-Z_{a-1,t-1}))}
    \tag{7}
\end{equation}\]</span>
and the natural mortality
<span class="math display" id="eq:getM">\[\begin{equation}
    M_{a-1,t-1}=Z_{a-1,t-1}-F_{a-1,t-1}.
    \tag{8}
\end{equation}\]</span></p>
<p>After a simulation we get the numbers at age and the numbers caught at age</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>numbers</span> <span class='op'>&lt;-</span> <span class='fu'>get_num_by_year_by_age</span><span class='op'>(</span><span class='va'>sim</span><span class='op'>)</span></span>
<span><span class='va'>catch</span> <span class='op'>&lt;-</span> <span class='fu'>get_catch_by_year_by_age</span><span class='op'>(</span><span class='va'>sim</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The <code>get_catch_by_year_by_age</code> function works the same as <code>get_num_by_year_by_age</code>, but prior to the numbers in size classes being summed over ages, they are multiplied by the size, species specific fishing mortality, acquired from <code>getFMort</code>. The catch here is the same as in mizerâs <code>getYield</code>.</p>
<p>We calculate equations <a href="#eq:getZ">(6)</a> and <a href="#eq:getF">(7)</a> for the <code>i</code>th year, <code>j</code>th species and <code>k</code>th age class to get <span class="math inline">\(Z_{i,k}\)</span> and <span class="math inline">\(F_{i,k}\)</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(numbers[i<span class="sc">+</span><span class="dv">1</span>,j,k<span class="sc">+</span><span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">log</span>(numbers[i,j,k])</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>F_m <span class="ot">&lt;-</span> catch[i<span class="dv">-1</span>,j,k]<span class="sc">*</span>z<span class="er">)</span><span class="sc">/</span>(numbers[i,j,k]<span class="sc">-</span>next_alive) <span class="do">### F_m rather than F as F is protected</span></span></code></pre></div>
</div>
<p>and equation <a href="#eq:getM">(8)</a> to get <span class="math inline">\(M_{i,k}\)</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='va'>z</span> <span class='op'>-</span> <span class='va'>F_m</span></span></code></pre>
</div>
</div>
<p>Figure <a href="#fig:Z-plot">5</a> is the emergent <span class="math inline">\(Z\)</span>, <span class="math inline">\(F\)</span> and <span class="math inline">\(M\)</span> over time using the historical fishing mortality.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Z-plot"></span>
<img src="pictures/Zs_plot_whiting.png" alt="Plots depict the $Z$, $F$ and $M$ rates for whiting of different ages over time" width="80%" />
<p class="caption">
Figure 5: Plots depict the <span class="math inline">\(Z\)</span>, <span class="math inline">\(F\)</span> and <span class="math inline">\(M\)</span> rates for whiting of different ages over time
</p>
</div>
</div>
<h1 id="sec:Sens">Sensitivity to <code>no_w</code> and <code>dt</code></h1>
<p>Due to the numerical integration of the partial differential equation (pde) in mizer, the II do not follow the distribution of fish density exactly and this sometimes results in negative <span class="math inline">\(M\)</span>. To investigate this we followed one individual and their growth for different values of <code>dt</code> and <code>no_w</code>. We initialised the <code>params</code> object for <code>no_w</code> equal to 100, 1000 and 10000</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>params</span> <span class='op'>&lt;-</span> <span class='fu'>newMultispeciesParams</span><span class='op'>(</span><span class='va'>NS_params</span><span class='op'>@</span><span class='va'>species_params</span>, no_w <span class='op'>=</span> <span class='va'>no_w</span><span class='op'>)</span></span>
<span><span class='va'>allgrow</span> <span class='op'>&lt;-</span> <span class='fu'>getEGrowth</span><span class='op'>(</span><span class='va'>params</span><span class='op'>)</span></span>
<span><span class='va'>gs</span> <span class='op'>&lt;-</span> <span class='va'>allgrow</span><span class='op'>[</span><span class='fl'>6</span>,<span class='op'>]</span></span></code></pre>
</div>
</div>
<p>and assumed a constant growth rate <code>gs</code> for a whiting individual. We initialised the population at zero except in the first size class where we set it so that there was only one individual.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>num</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>params</span><span class='op'>@</span><span class='va'>w</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>num</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='va'>params</span><span class='op'>@</span><span class='va'>dw</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span></code></pre>
</div>
</div>
<p>Assuming no mortality and no recruitment we updated the numbers at size for 10 years using the numerical pde solver in mizer (see supplementary for the code) and compared the size distribution with the size of an II at the same age.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:quantiles"></span>
<img src="pictures/quantiles.png" alt="Comparison of II size prediction to mizer's numerical solution. The grid cell value is the proportion of individuals in the numerical solution that are smaller than the II. Each simulation has a different `dt` and `no_w`." width="500px" height="500px" />
<p class="caption">
Figure 6: Comparison of II size prediction to mizerâs numerical solution. The grid cell value is the proportion of individuals in the numerical solution that are smaller than the II. Each simulation has a different <code>dt</code> and <code>no_w</code>.
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sensitive"></span>
<img src="pictures/SENSITIVEGRID.png" alt="The numerical solution of the growth with different `dt` and `no_w`. Each plot contains 3 lines, indicating a different value of `dt` - black is 0.1, blue is 0.01 and red is 0.001. Each row of plots indicates that the example's `no_w`, increasing from top to bottom. The left columns shows age 1 and right age 4." width="600px" height="600px" />
<p class="caption">
Figure 7: The numerical solution of the growth with different <code>dt</code> and <code>no_w</code>. Each plot contains 3 lines, indicating a different value of <code>dt</code> - black is 0.1, blue is 0.01 and red is 0.001. Each row of plots indicates that the exampleâs <code>no_w</code>, increasing from top to bottom. The left columns shows age 1 and right age 4.
</p>
</div>
</div>
<p>We compared the proportion of individuals that are smaller than the II and found that as <code>dt</code> got smaller and <code>no_w</code> got bigger the proportion approached 50%, Figure <a href="#fig:quantiles">6</a>. Further, as <code>dt</code> got smaller and <code>no_w</code>got bigger the range of sizes at age decreased Figure <a href="#fig:sensitive">7</a>.</p>
<p>Therefore for more accurate age-based information we are required to choose a finer resolution for the numerical solver in mizer. We demonstrate this on the North Sea model for values of <code>dt</code> equal to 0.1, 0.01 and 0.001, and <code>no_w</code> equal to 100, 1000 and 2000.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption><span id="tab:unnamed-chunk-17">Table 1: </span>Proportion of Negative Ms in ages 1 to 6 for all species. The rows represent different <code>dt</code>s and the columns different <code>no_w</code>. We did not run it for <code>dt=0.001</code> and <code>no_w=2000</code> as the file was too large.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">100</th>
<th style="text-align: right;">1000</th>
<th style="text-align: right;">2000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.1</td>
<td style="text-align: right;">0.1015873</td>
<td style="text-align: right;">0.0099206</td>
<td style="text-align: right;">0.002381</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.01</td>
<td style="text-align: right;">0.0746032</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.001</td>
<td style="text-align: right;">0.0726190</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<p>Decreasing <code>dt</code> and increasing <code>no_w</code> makes the numerial integration more accurate and stablises the results. This comes at a cost, as the <code>MizerSim</code> object gets very large.</p>
<h1 id="discussion">Discussion</h1>
<p>Most models used in advice are age-based. In this blog post, we have introduced a way of calculating emergent age in mizer, potentially increasing the utility of mizer when it comes to giving management advice.</p>
<p>For example, mizer could be used as an operating model for MSEs. A common MSE framework is to use an operating model to test management actions. The operating model stands in for reality and management actions, such as harvest control rules, are run <span class="citation" data-cites="punt_MSE">(<a href="#ref-punt_MSE" role="doc-biblioref">Punt et al. 2016</a>)</span>. This process involves the operating model generating data, which assessment models are fitted to. As data for assessment models is age resolved, the operating model has to be able to sample age resolved data. By introducing emergent age in mizer, mizer can now generate age-based data, meaning that it can be used as an operating model in the MSE frameworks.</p>
<p>Some category 1 assessments, those that have full analytical assessments, use natural mortality at age from fitted multispecies models as inputs to the assessment. For example, many North Sea stocks use natural mortality estimates from the stochastic multispecies model <span class="citation" data-cites="sms">(<a href="#ref-sms" role="doc-biblioref">Lewy and Vinther 2004</a>)</span>. Typically, assessment models require natural mortality at age rather than size. In Section <a href="#sec:Zatage"><strong>??</strong></a> we showed that we can calculate emergent natural mortality at age. Therefore, coupled with dynamical fitting, <span class="citation" data-cites="spence_cs">(<a href="#ref-spence_cs" role="doc-biblioref">Spence et al. 2021</a>)</span>, mizer could be used to provide natural mortality estimates as inputs to single-species assessments.</p>
<p>Many data collection schemes are designed to be fit to age-based models, for example, length stratified sample is used on surveys to calculate age-length keys. For these reasons, it can be difficult to incorporate age-based data when calibrating mizer. Furthermore, the data collected are not in a steady state (e.g., see Figure <a href="#fig:historic-weights">3</a>). Using the ages process described here, we can compare these data with mizer. For example, growth could be tuned by looking at emergent growth rates rather than steady states.</p>
<p>In many cases, fishing mortality from stock assessments has been used to drive the dynamics of the mizer model <span class="citation" data-cites="blanchard spence_ns spence_prec">(<a href="#ref-blanchard" role="doc-biblioref">Blanchard et al. 2014</a>; <a href="#ref-spence_ns" role="doc-biblioref">Spence, Blackwell, and Blanchard 2016</a>; <a href="#ref-spence_prec" role="doc-biblioref">Spence et al. 2024</a>)</span>. Typically fishing mortality from stock assessments is age-based. In previous studies, the fishing mortality inputs were some kind of average, for example Fbar, or some steady-state assumption about age <span class="citation" data-cites="spence_prec">(<a href="#ref-spence_prec" role="doc-biblioref">Spence et al. 2024</a>)</span>. Using this approach, age-based fishing mortality can be implemented in age classes as they change size throughout the simulation as done in the assessment. However, how selectivity occurs within an age can be difficult to calculate <span class="citation" data-cites="spence_prec">(<a href="#ref-spence_prec" role="doc-biblioref">Spence et al. 2024</a>)</span>, particularly at lower ages.</p>
<p>The work presented here is exact in the limit when <code>dt</code> and <code>dw</code> are 0, however practically this is not possible. We showed that as <code>dt</code> and <code>dw</code> get smaller the age estimation becomes more accurate, however, inaccuracies in the ageing process can lead to some strange behaviour. For example, we found that for the default values of <code>dt</code> and <code>dw</code> some cohorts natural mortality was less than 0, i.e.Â <span class="math inline">\(M&lt;0\)</span>, which could cause difficulties when comparing mizer to age-based models. This could be caused by the numerical integration and/or how we say the lengths of fish within an age class are distributed. More research is required, although we suspect these problems occur due to how the emergent catch is calculated.</p>
<p>In this blog post, we introduced an extension that allows you to calculate dynamic growth curves and ages at size in mizer. This addition will improve how mizer is calibrated to data and also allows it to be interpreted and compared to age-based models, potentially increasing the utility of mizer in the assessment and advice process.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Andersen_book" class="csl-entry" role="listitem">
Andersen, Ken H. 2019. <em>Fish Ecology, Evolution, and Exploitation: A New Theoretical Synthesis</em>. Princeton University Press.
</div>
<div id="ref-blanchard" class="csl-entry" role="listitem">
Blanchard, Julia L., Ken H. Andersen, Finlay Scott, Niels T. Hintzen, Gerjan Piet, and Simon Jennings. 2014. <span>âEvaluating Targets and Trade-Offs Among Fisheries and Conservation Objectives Using a Multispecies Size Spectrum Model.â</span> <em>Journal of Applied Ecology</em> 51 (3): 612â22. <a href="https://doi.org/10.1111/1365-2664.12238">https://doi.org/10.1111/1365-2664.12238</a>.
</div>
<div id="ref-hartvig" class="csl-entry" role="listitem">
Hartvig, Martin, Ken H. Andersen, and Jan E. Beyer. 2011. <span>âFood Web Framework for Size-Structured Populations.â</span> <em>Journal of Theoretical Biology</em> 272 (1): 113â22. <a href="https://doi.org/10.1016/j.jtbi.2010.12.006">https://doi.org/10.1016/j.jtbi.2010.12.006</a>.
</div>
<div id="ref-ICES2024" class="csl-entry" role="listitem">
ICES. 2024. <span>âWorking Group on Multispecies Assessment Methods (WGSAM; Outputs from 2023 Meeting).â</span> <a href="https://doi.org/10.17895/ices.pub.25020968.v3">https://doi.org/10.17895/ices.pub.25020968.v3</a>.
</div>
<div id="ref-sms" class="csl-entry" role="listitem">
Lewy, Peter, and Morten Vinther. 2004. <span>âA Stochastic Age-Length-Structured Multispecies Model Applied to North Sea Stocks.â</span> ICES.
</div>
<div id="ref-sam" class="csl-entry" role="listitem">
Nielsen, Anders, and Casper W. Berg. 2014. <span>âEstimation of Time-Varying Selectivity in Stock Assessments Using State-Space Models.â</span> <em>Fisheries Research</em> 158: 96â101. <a href="https://doi.org/10.1016/j.fishres.2014.01.014">https://doi.org/10.1016/j.fishres.2014.01.014</a>.
</div>
<div id="ref-punt_MSE" class="csl-entry" role="listitem">
Punt, Andre E., Doug S. Butterworth, Carryn L. de Moor, JosÃ© A. A. De Oliveira, and Malcolm Haddon. 2016. <span>âManagement Strategy Evaluation: Best Practices.â</span> <em>Fish and Fisheries</em> 17 (2): 303â34. <a href="https://doi.org/10.1111/faf.12104">https://doi.org/10.1111/faf.12104</a>.
</div>
<div id="ref-mizer" class="csl-entry" role="listitem">
Scott, Finlay, Julia L. Blanchard, and Ken H. Andersen. 2014. <span>âMizer: An r Package for Multispecies, Trait-Based and Community Size Spectrum Ecological Modelling.â</span> <em>Methods in Ecology and Evolution</em> 5 (10): 1121â25. <a href="https://doi.org/10.1111/2041-210X.12256">https://doi.org/10.1111/2041-210X.12256</a>.
</div>
<div id="ref-spence_ns" class="csl-entry" role="listitem">
Spence, Michael A., Paul G. Blackwell, and Julia L. Blanchard. 2016. <span>âParameter Uncertainty of a Dynamic Multispecies Size Spectrum Model.â</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 73 (4): 589â97. <a href="https://doi.org/10.1139/cjfas-2015-0022">https://doi.org/10.1139/cjfas-2015-0022</a>.
</div>
<div id="ref-spence_prec" class="csl-entry" role="listitem">
Spence, Michael A., James A. Martindale, Khatija Alliji, Hayley J. Bannister, Robert B. Thorpe, Nicola D. Walker, Peter J. Mitchell, Matthew R. Kerr, and Paul J. Dolder. 2024. <span>âAssessing the Effect of Multispecies Interactions on Precautionary Reference Points Using an Ensemble Modelling Approach: A North Sea Case Study.â</span> <em>Fisheries Research</em> 280: 107160. <a href="https://doi.org/10.1016/j.fishres.2024.107160">https://doi.org/10.1016/j.fishres.2024.107160</a>.
</div>
<div id="ref-spence_cs" class="csl-entry" role="listitem">
Spence, Michael A., Robert B. Thorpe, Paul G. Blackwell, Finlay Scott, Richard Southwell, and Julia L. Blanchard. 2021. <span>âQuantifying Uncertainty and Dynamical Changes in Multi-Species Fishing Mortality Rates, Catches and Biomass by Combining State-Space and Size-Based Multi-Species Models.â</span> <em>Fish and Fisheries</em> 22 (4): 667â81. <a href="https://doi.org/10.1111/faf.12543">https://doi.org/10.1111/faf.12543</a>.
</div>
<div id="ref-Trijoulet_19" class="csl-entry" role="listitem">
Trijoulet, Vanessa, Gavin Fay, Kiersten L. Curti, Brian Smith, and Timothy J. Miller. 2019. <span>âPerformance of Multispecies Assessment Models: Insights on the Influence of Diet Data.â</span> <em>ICES Journal of Marine Science</em> 76 (6): 1464â76. <a href="https://doi.org/10.1093/icesjms/fsz053">https://doi.org/10.1093/icesjms/fsz053</a>.
</div>
<div id="ref-Trijoulet_20" class="csl-entry" role="listitem">
Trijoulet, Vanessa, Gavin Fay, and Timothy J. Miller. 2020. <span>âPerformance of a State-Space Multispecies Model: What Are the Consequences of Ignoring Predation and Process Errors in Stock Assessments?â</span> <em>Journal of Applied Ecology</em> 57 (1): 121â35. <a href="https://doi.org/10.1111/1365-2664.13515">https://doi.org/10.1111/1365-2664.13515</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2025-04-02-age-in-mizer/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Age%20in%20mizer&amp;url=https%3A%2F%2Fblog.mizer.sizespectrum.org%2Fposts%2F2025-04-02-age-in-mizer%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://mizer.disqus.com/count.js" async></script>
  <div id="disqus_thread"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/';
  this.page.identifier = 'posts/2025-04-02-age-in-mizer/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://mizer.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/sizespectrum/MizerBlog/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/sizespectrum/MizerBlog/">https://github.com/sizespectrum/MizerBlog/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Broadbent &amp; Spence (2025, April 2). mizer blog: Age in mizer. Retrieved from https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{broadbent2025age,
  author = {Broadbent, Luke and Spence, Michael A.},
  title = {mizer blog: Age in mizer},
  url = {https://blog.mizer.sizespectrum.org/posts/2025-04-02-age-in-mizer/},
  year = {2025}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
